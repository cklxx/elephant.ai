name: thinking_fallback
description: "When agent returns empty answer but has thinking content, thinking is used as reply"
tags: [thinking, fallback]

setup:
  config:
    session_prefix: "test-lark"
    allow_direct: true
  llm_mode: mock

turns:
  - sender_id: "ou_user_think"
    chat_id: "oc_chat_think"
    message_id: "om_msg_think_001"
    content: "测试思考回退"

    mock_response:
      answer: ""
      # When answer is empty, the gateway falls back to thinking content.
      # However in mock mode, we can't easily inject thinking parts through
      # the mock executor. This scenario tests that an empty answer still
      # produces a reply (the fallback "无可用回复" message).

    assertions:
      messenger:
        - method: ReplyMessage
          # Empty answer with no thinking content should produce the fallback.
          content_contains: ["无可用回复"]
