# 存储与元数据治理验收方案

## 1. 环境准备
- 新建存储根目录（示例：`/srv/local-av`），设置读写权限。  
- 部署 `sha256sum`, `rsync` 工具。  
- 准备样例素材、输出、缓存文件。

## 2. 功能用例
| 编号 | 场景 | 操作 | 期望结果 |
| --- | --- | --- | --- |
| STO-001 | 路径归一化 | 输入包含 `..` 的相对路径 | 返回错误，拒绝访问 |
| STO-002 | 文件写入 | 调用 `WriteFile` 写缓存 | 文件创建成功，校验和文件同步生成 |
| STO-003 | 只读模式 | 设置 `read_only=true` 后写入 | 返回 `ErrReadOnly` |
| STO-004 | 自动清理 | 运行清理脚本 | 过期缓存被删除，生成报告 |
| STO-005 | 备份恢复 | 触发备份并恢复 | 恢复后的文件校验和一致 |

## 3. 性能指标
- 单次 `Resolve` 调用耗时 < 1ms（1000 次取平均）。  
- 写入 100MB 文件时吞吐 ≥ 150MB/s（SSD 环境）。  
- 清理脚本可在 5 分钟内扫描 10 万文件。

## 4. 审计要求
- `metadata/jobs/*.json` 记录任务 ID、用户、时间、输入输出清单。  
- 文件操作日志包含：操作者、动作、路径、结果。  
- 备份日志保存 30 天以上。

## 5. 交付物
- 存储策略配置样例。  
- `storage_audit.sh` + 使用说明。  
- 备份/恢复脚本及测试记录。

## 6. 流程
1. 实施方演示所有用例并提供日志。  
2. 甲方验证备份恢复后的文件完整性。  
3. 双方确认性能指标与审计要求。  
4. 完成验收报告并归档。
