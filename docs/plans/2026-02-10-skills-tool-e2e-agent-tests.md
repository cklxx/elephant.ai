# Plan: Skills Tool E2E Agent Tests (2026-02-10)

## Goal
Design and implement per-skill end-to-end agent tests that verify `skills` tool effectiveness across all repository skills.

## Scope
- Add a YAML case set with one E2E case per skill.
- Add a Python runner that executes `./alex` per case and evaluates effectiveness signals.
- Add unit tests for case loading, prompt/output parsing, and verdict logic.
- Add usage documentation for running full suite or subsets.

## Out of Scope
- Changing skill business logic (`skills/*/run.py`) behavior.
- Replacing the existing `alex eval` framework.

## Implementation Plan
1. [x] Add `evaluation/skills_e2e/cases.yaml` with per-skill test definitions (generated by script).
2. [ ] Implement runner `scripts/skill_runner/agent_e2e.py`:
   - load cases
   - execute real `./alex` commands
   - parse transcript + JSON output
   - produce JSON/Markdown report
3. [x] Add unit tests for case generation logic (`scripts/skill_runner/tests/test_generate_agent_e2e_cases.py`).
4. [ ] Add docs `docs/guides/skills-agent-e2e-testing.md` with runbook.
5. [x] Validate current deliverables by running:
   - `pytest scripts/skill_runner/tests -q`
   - `pytest skills/*/tests scripts/skill_runner/tests -q`
   - `./scripts/run-golangci-lint.sh run ./...`
   - `make test`
6. [ ] Validate full real-agent subset run (3 cases) after runner lands.

## Risks and Mitigations
- Upstream LLM instability/rate limits: add retry and classify transient errors separately.
- Output parsing fragility: implement robust JSON object extraction + explicit required fields.
- Long runtime for full suite: support `--limit` and `--skills` filters.

## Progress Log
- 2026-02-10 16:00: Created plan and locked implementation scope.
- 2026-02-10 16:40: Added per-skill case generator script (`scripts/skill_runner/generate_agent_e2e_cases.py`) and generated `evaluation/skills_e2e/cases.yaml` (30 cases).
- 2026-02-10 16:43: Added generator unit tests (`scripts/skill_runner/tests/test_generate_agent_e2e_cases.py`) and validated all Python skill tests pass.
- 2026-02-10 16:45: Fixed `image-creation` endpoint fallback and pytest collection conflicts; full lint + full Go tests passing.
