# Lark Mentions（@）使用说明

## 1) 群聊里“@ 机器人”才能被收到（常见原因）

在 Lark 群聊里，机器人是否能收到**所有群消息**取决于应用权限/订阅能力：

- 只开通“获取用户在群组中@机器人的消息”：机器人**只能收到被 @ 的消息**。
- 开通“获取群组中所有消息”：机器人才能收到**群内所有消息**。

如果你在群里打字里出现了类似 `@cli_xxx` 的字符串，但没有从 Lark 客户端的 @ 选择器里真正选择机器人，那么平台通常不会把它当作“@ 机器人”，机器人也就收不到（或收不到你期望的那类消息）。

## 2) 机器人在群里 @ 人 / @all（发送侧）

对 Lark **text** 类型消息，`content.text` 支持插入 `<at ...>` 标签：

- @ 某个用户（`user_id` 一般是 open_id，形如 `ou_...`）：
  - `你好 <at user_id="ou_xxx">张三</at>`
- @ 所有人：
  - `<at user_id="all">所有人</at> 重要通知...`

> 注意：这里需要的是 **用户标识（open_id/user_id）**，不是 app_id / 机器人实例名。

## 3) 接收侧解析（本项目现状）

本项目会把收到的 text 里 `<at user_id="...">Name</at>` 渲染成 `@Name(user_id)` 的可读文本，便于模型理解与引用。

