"use client";

import type { ReactNode } from "react";
import { useCallback } from "react";
import { create } from "zustand";
import { persist } from "zustand/middleware";

export type Language = "en";

const translations = {
  en: {
    "app.loading": "Loading console…",
    "auth.account.loading": "Checking session…",
    "auth.account.menuTitle": "Account",
    "auth.account.signedInAs": "Signed in as {email}",
    "auth.account.logout": "Sign out",
    "auth.account.login": "Sign in",
    "auth.account.points": "Points: {count}",
    "auth.account.subscriptionFree": "Plan: {tier}",
    "auth.account.subscriptionPaid": "Plan: {tier} ({price}/mo)",
    "auth.account.subscriptionExpires": "Renews {date}",
    "auth.subscription.tier.free": "Free",
    "auth.subscription.tier.supporter": "Supporter",
    "auth.subscription.tier.professional": "Professional",
    "auth.login.title": "Sign in to continue",
    "auth.login.subtitle": "Use your assigned console credentials.",
    "auth.login.emailLabel": "Email address",
    "auth.login.passwordLabel": "Password",
    "auth.login.errorPrefix": "Unable to sign in:",
    "auth.login.pending": "Signing in…",
    "auth.login.submit": "Sign in",
    "auth.login.genericError": "Authentication failed",
    "auth.login.invalidCredentials": "Invalid email or password",
    "auth.login.mode.signIn": "Sign in",
    "auth.login.mode.register": "Create account",
    "auth.login.emailDivider": "Or continue with email",
    "auth.login.noAccount": "Need an account?",
    "auth.login.switchToRegister": "Create one",
    "auth.login.needHelp": "Need access?",
    "auth.login.contactAdmin": "Contact your administrator",
    "auth.register.title": "Create your account",
    "auth.register.subtitle": "Use your work email to join the console.",
    "auth.register.displayNameLabel": "Full name",
    "auth.register.displayNamePlaceholder": "Jane Doe",
    "auth.register.passwordLabel": "Create a password",
    "auth.register.confirmPasswordLabel": "Confirm password",
    "auth.register.passwordMismatch": "Passwords do not match",
    "auth.register.pending": "Creating account…",
    "auth.register.submit": "Create account",
    "auth.register.emailDivider": "Or sign up with email",
    "auth.register.emailExists": "This email is already registered",
    "auth.register.passwordInvalid": "Password does not meet requirements",
    "auth.register.genericError": "Unable to create your account",
    "auth.register.haveAccount": "Already a member?",
    "auth.register.switchToLogin": "Sign in",
    "auth.oauth.google": "Continue with Google",
    "auth.oauth.wechat": "Continue with WeChat",
    "auth.oauth.pending": "Connecting…",
    "auth.oauth.wechat.title": "Scan with WeChat",
    "auth.oauth.wechat.subtitle": "Scan the QR code in the WeChat app to sign in.",
    "auth.oauth.wechat.cancel": "Cancel",
    "auth.oauth.wechat.generating": "Generating QR code…",
    "auth.oauth.wechat.qrError": "Unable to generate QR code",
    "auth.oauth.wechat.alt": "WeChat login QR code",
    "auth.oauth.wechat.status.initializing": "Preparing your QR code…",
    "auth.oauth.wechat.status.waiting": "Scan the code in WeChat to continue.",
    "auth.oauth.wechat.status.refreshing": "Refreshing QR code…",
    "auth.oauth.wechat.status.expired": "QR code expired—generating a new one…",
    "auth.oauth.wechat.status.error": "We couldn't finish WeChat login. Cancel and try again.",
    "auth.oauth.popupBlocked": "Allow pop-ups to continue",
    "auth.oauth.timeout": "Authentication timed out",
    "auth.oauth.unsupported": "Open this page in a browser to sign in",
    "auth.oauth.unavailable": "Provider is not available",
    "auth.oauth.genericError": "Unable to start social login",
    "timeline.label": "Execution timeline",
    "timeline.waiting": "Waiting for execution to begin",
    "timeline.status.inProgress": "In progress: {title}",
    "timeline.status.attention": "Needs attention: {title}",
    "timeline.status.recent": "Recently completed: {title}",
    "timeline.progress": "Completed {completed}/{total}",
    "console.brand": "elephant.ai Console",
    "home.hero.label": "Research workspace",
    "home.hero.title": "Run focused research",
    "home.hero.subtitle": "Open the console and steer runs live.",
    "home.hero.ctaPrimary": "Open conversation view",
    "home.hero.ctaSecondary": "Browse sessions",
    "navigation.sessions": "Session archive",
    "home.feature.chat.title": "Chat-first",
    "home.feature.chat.description":
      "View prompts, replies, and actions together.",
    "home.feature.actions.title": "Live actions",
    "home.feature.actions.description":
      "Watch tool runs with inline status and results.",
    "home.summary.sessions.label": "Sessions",
    "home.summary.sessions.value": "Unlimited history",
    "home.summary.sessions.description":
      "Rename and reopen runs in seconds.",
    "home.summary.timeline.label": "Timeline",
    "home.summary.timeline.value": "Step-by-step focus",
    "home.summary.timeline.description":
      "Jump to steps on any screen and stay in sync.",
    "home.summary.languages.label": "Languages",
    "home.summary.languages.value": "English",
    "home.summary.languages.description": "Interface available in English.",
    "console.heading.active": "Session {id}",
    "console.heading.idle": "New task",
    "console.hero.label": "elephant.ai workspace",
    "console.hero.title.active": "Continuing session {id}",
    "console.hero.title.idle": "What should we work on today?",
    "console.hero.subtitle": "Describe the goal in one line.",
    "console.connection.title": "Status",
    "console.connection.subtitle": "Live",
    "console.connection.mock": "Mock stream enabled",
    "console.connection.newConversation": "Start new conversation",
    "console.settings.title": "Workspace",
    "console.settings.timelineStatus": "Timeline",
    "console.settings.sessionStatus": "Session state",
    "console.settings.reset": "Reset",
    "console.settings.sessionLabel": "Current session",
    "console.settings.sessionEmpty": "None",
    "console.settings.sessionNone": "No session",
    "console.history.title": "Session history",
    "console.history.subtitle": "Latest runs",
    "console.history.empty": "No sessions",
    "console.history.emptyDescription": "Run a task to add one",
    "console.history.recents": "Recent",
    "console.history.rename": "Rename session",
    "console.history.renamePlaceholder": "Session name",
    "console.history.renameConfirm": "Save name",
    "console.history.renameCancel": "Cancel rename",
    "console.history.clearSelection": "Clear",
    "console.history.itemPrefix": "Session {id}",
    "console.quickstart.title": "快速开始",
    "console.quickstart.items.image": "画图",
    "console.quickstart.items.article": "文章",
    "console.quickstart.items.video": "生成视频",
    "console.thread.sessionPrefix": "Session {id}",
    "console.thread.newConversation": "Live feed",
    "console.thread.autosave": "Autosave on",
    "conversation.header.label": "Conversation",
    "conversation.header.active": "Session {id}",
    "conversation.header.activeLabel": "Active session",
    "conversation.header.idle": "Start new run",
    "conversation.header.subtitle": "Agent activity stays in the stream.",
    "conversation.mode.console": "对话",
    "conversation.quickstart.subtitle": "Pick a prompt.",
    "conversation.quickstart.useSuggestion": "Use: {suggestion}",
    "conversation.status.doing": "Working…",
    "conversation.status.completed": "Completed",
    "conversation.status.failed": "Failed",
    "conversation.status.listening": "Listening…",
    "conversation.tools.simpleSummary.heading": "Tool calls this session",
    "conversation.tools.simpleSummary.inputsLabel": "Inputs",
    "conversation.tools.simpleSummary.outputLabel": "Output",
    "conversation.tools.simpleSummary.errorLabel": "Error",
    "conversation.tools.simpleSummary.policy.standard": "standard isolation",
    "conversation.tools.simpleSummary.policy.filesystem": "filesystem guard",
    "conversation.tools.simpleSummary.policy.system": "system guard",
    "conversation.tool.timeline.started": "{tool} started",
    "conversation.tool.timeline.streaming": "Streaming",
    "conversation.tool.timeline.liveOutput": "Live output",
    "conversation.tool.timeline.completed": "Complete",
    "conversation.tool.timeline.errored": "Error",
    "conversation.tool.timeline.duration": "{duration}",
    "conversation.tool.timeline.arguments": "Inputs",
    "conversation.tool.timeline.errorOutput": "Errors",
    "conversation.tool.timeline.result": "{tool} result",
    "conversation.tool.timeline.metadata": "Context",
    "conversation.tool.timeline.summaryRunning": "{tool} is running…",
    "conversation.tool.timeline.summaryCompleted": "{tool} finished running.",
    "conversation.tool.timeline.summaryErrored": "{tool} reported an error.",
    "console.timeline.mobileLabel": "Timeline snapshot",
    "console.timeline.dialogTitle": "Execution timeline",
    "console.timeline.dialogDescription": "Select a step to focus.",
    "console.timeline.sidebarTitle": "Timeline",
    "console.timeline.sidebarDescription": "Select a step.",
    "console.empty.badge": "Waiting",
    "console.empty.title": "Ready to start",
    "console.input.placeholder.active": "输入 /plan 即可提问",
    "console.input.placeholder.idle": "输入 /plan 即可提问",
    "console.input.hotkeyHint": "Enter sends · Shift+Enter newline",
    "console.sandbox.title": "Agent screen",
    "console.sandbox.subtitle": "See what the agent is doing, or open the live view.",
    "console.sandbox.running": "In progress",
    "console.sandbox.show": "View live",
    "console.sandbox.hide": "Close viewer",
    "console.sandbox.refresh": "Update snapshot",
    "console.sandbox.external": "Open in new tab",
    "console.sandbox.loading": "Connecting to live view…",
    "console.sandbox.error": "Can't open the live view.",
    "console.sandbox.noSession": "Start a session to see the agent screen.",
    "console.sandbox.noVnc": "Live view isn't available yet. You can still use the snapshot.",
    "console.sandbox.snapshotAlt": "Latest snapshot",
    "console.toast.taskFailed": "Task execution failed",
    "console.toast.taskStarted.title": "Task started",
    "console.toast.taskStarted.description":
      "The agent is working on your request.",
    "console.toast.taskCancelRequested.title": "Cancellation requested",
    "console.toast.taskCancelRequested.description":
      "Attempting to stop the running task.",
    "console.toast.taskCancelError.title": "Failed to cancel task",
    "console.toast.taskCancelError.description": "Reason: {message}",
    "agent.output.heading": "Agent output",
    "agent.output.tabs.timeline": "Timeline",
    "agent.output.tabs.events": "Events",
    "agent.output.tabs.document": "Document",
    "agent.output.timeline.empty": "No timeline steps yet",
    "agent.output.document.title": "Task result",
    "agent.output.document.fallback": "Task completed successfully",
    "agent.output.document.empty": "Document will appear when task completes",
    "agent.output.plan.defaultGoal": "Research and execute task",
    "agent.output.toolOutputs.title": "Tool outputs",
    "agent.output.toolOutputs.empty": "No tool outputs yet",
    "agent.output.toolOutputs.emptyHint":
      "Results will appear here as tools execute",
    "connection.connected": "Connected",
    "connection.reconnecting": "Reconnecting…",
    "connection.disconnected": "Offline",
    "connection.reconnect": "Retry",
    "document.empty.title": "No document selected",
    "document.empty.description": "Document content will appear here",
    "document.view.default": "Default",
    "document.view.reading": "Reading",
    "document.view.compare": "Compare",
    "document.attachments.filters.heading": "Attachment filters",
    "document.attachments.filters.kind.all": "All",
    "document.attachments.filters.kind.attachments": "Media",
    "document.attachments.filters.kind.artifacts": "Artifacts",
    "document.attachments.filters.format.label": "Format",
    "document.attachments.filters.format.all": "All formats",
    "document.attachments.filters.search.label": "Search",
    "document.attachments.filters.search.placeholder":
      "Search by name, description, or format",
    "document.attachments.filters.empty":
      "No attachments match the current filters.",
    "timeline.card.title": "Execution Timeline",
    "timeline.card.subtitle": "Track each step at a glance.",
    "timeline.card.progressLabel": "Progress",
    "timeline.card.progressSummary": "{{completed}} of {{total}} complete",
    "timeline.card.totalDuration": "Elapsed {{duration}}",
    "timeline.card.toolsUsed": "Tools used:",
    "timeline.card.tokensUsed": "Tokens used:",
    "timeline.card.error": "Error:",
    "timeline.card.expand": "Expand details",
    "timeline.card.collapse": "Collapse details",
    "timeline.card.badge.pending": "Pending",
    "timeline.card.badge.active": "In progress",
    "timeline.card.badge.complete": "Complete",
    "timeline.card.badge.error": "Failed",
    "timeline.column.plan": "Plan",
    "timeline.column.planEmpty": "No planned steps yet.",
    "timeline.column.inProgress": "In progress",
    "timeline.column.inProgressEmpty":
      "Execution will appear here once steps begin.",
    "timeline.column.history": "History",
    "timeline.column.historyEmpty": "Completed steps will collect here.",
    "plan.title": "Research Plan",
    "plan.caption.default": "Review and approve to start execution",
    "plan.caption.readonly": "Approved plan",
    "plan.collapse": "Collapse plan",
    "plan.expand": "Expand plan",
    "plan.goal.label": "Goal:",
    "plan.steps.label": "Planned steps ({count}):",
    "plan.steps.status.planned": "Planned",
    "plan.steps.status.active": "In progress",
    "plan.steps.status.done": "Completed",
    "plan.steps.status.failed": "Needs attention",
    "plan.steps.focus": "Focus step {index}",
    "plan.steps.focusLabel": "Focus in timeline",
    "plan.steps.focusActive": "Jump to active step",
    "plan.iterations": "Iterations:",
    "plan.tools": "Tools:",
    "plan.tools.more": "+{count} more",
    "plan.estimates.iterations": "{count} iteration(s) est.",
    "plan.estimates.tools": "{count} tool(s) est.",
    "plan.estimates.durationMinutes": "≈ {minutes} min",
    "plan.estimates.durationHours": "≈ {hours} hr",
    "plan.estimates.durationHoursMinutes": "≈ {hours} hr {minutes} min",
    "plan.actions.saveChanges": "Save changes",
    "plan.actions.cancel": "Cancel",
    "plan.actions.approve": "Approve & start",
    "plan.actions.modify": "Modify plan",
    "plan.actions.reject": "Reject plan",
    "plan.reject.reasonLabel": "Rejection reason",
    "plan.reject.placeholder": "Why is this plan not ready to execute?",
    "plan.reject.confirm": "Confirm rejection",
    "plan.reject.cancel": "Cancel",
    "plan.progress.heading": "Execution summary",
    "plan.progress.completed": "Completed {completed}/{total} steps",
    "plan.progress.status.pending": "Not started",
    "plan.progress.status.inProgress": "In progress",
    "plan.progress.status.complete": "Completed",
    "plan.progress.status.error": "Requires attention",
    "plan.progress.activeStep": "Currently running: {title}",
    "plan.progress.latestCompleted": "Last completed: {title}",
    "plan.progress.viewInTimeline": "View in timeline",
    "plan.progress.totalDuration": "Total duration",
    "plan.progress.averageDuration": "Avg step duration",
    "plan.progress.tokens": "Tokens consumed",
    "plan.progress.uniqueTools": "Tools used",
    "plan.edit.goal": "Edit goal",
    "plan.edit.stepLabel": "Edit step {index}",
    "plan.move.up": "Move step {index} up",
    "plan.move.down": "Move step {index} down",
    "plan.move.dragHandle": "Reorder step {index}",
    "task.submit.title.running": "Running…",
    "task.submit.title.default": "Submit (Enter)",
    "task.submit.running": "Running",
    "task.submit.label": "Send",
    "task.stop.title": "Stop current task",
    "task.stop.label": "Stop",
    "task.stop.pending": "Stopping…",
    "task.input.attachImage": "Attach file",
    "task.input.removeAttachment": "Remove attachment {name}",
    "task.input.attachments.kind.attachment": "Attachment",
    "task.input.attachments.kind.artifact": "Artifact",
    "task.input.attachments.artifactHint":
      "Artifacts stay available for {days} days with inline previews.",
    "task.input.attachments.noPreview": "No preview",
    "task.input.ariaLabel": "Task input",
    "tool.status.failed": "Failed",
    "tool.status.running": "Running…",
    "tool.status.completed": "Completed",
    "tool.toggle.expand": "Expand output",
    "tool.toggle.collapse": "Collapse output",
    "tool.toggle.length": " · {count} characters",
    "tool.section.parameters": "Parameters",
    "tool.section.error": "Error",
    "tool.section.output": "Output",
    "viewport.empty.title": "No tool outputs yet",
    "viewport.empty.description": "Results will appear here as tools execute",
    "viewport.title": "Computer view",
    "viewport.position": "{index} of {total}",
    "viewport.aria.previous": "Previous output",
    "viewport.aria.next": "Next output",
    "viewport.aria.enterFullscreen": "Enter fullscreen mode",
    "viewport.aria.fullscreenViewer": "Fullscreen tool output viewer",
    "viewport.aria.exitFullscreen": "Exit fullscreen mode",
    "viewport.fullscreen.close": "Close",
    "viewport.web.url": "URL:",
    "viewport.web.screenshot": "Screenshot",
    "viewport.web.html": "HTML",
    "viewport.web.screenshotAlt": "Screenshot",
    "viewport.bash.command": "Command:",
    "viewport.bash.output": "Output:",
    "viewport.bash.errorOutput": "Error output:",
    "viewport.bash.exitCode": "Exit code:",
    "viewport.diff.split": "Side by side",
    "viewport.diff.unified": "Unified",
    "viewport.diff.before": "Before",
    "viewport.diff.after": "After",
    "viewport.diff.beforeHeading": "--- Before",
    "viewport.diff.afterHeading": "+++ After",
    "events.empty": "No events yet. Submit a task to get started.",
    "events.emptyTitle": "Awaiting agent activity",
    "events.emptyHint": "Send a task to watch updates stream in.",
    "events.scrollToLatest": "Jump to latest",
    "events.stream.ariaLabel": "Agent event stream",
    "events.stream.ariaDescription":
      "Live updates appear here. Scroll up to pause auto-scrolling.",
    "events.stream.newEventSingular": "1 new update from the agent.",
    "events.stream.newEventPlural": "{count} new updates from the agent.",
    "events.toolCall.label": "Tool Call",
    "events.toolCall.timelineLabel": "{tool} tool execution timeline",
    "events.toolCall.copyArguments": "Copy inputs",
    "events.toolCall.copyResult": "Copy result",
    "events.toolCall.copyError": "Copy error",
    "events.toolCall.copied": "Copied",
    "events.toolCall.id": "ID",
    "events.toolCall.start": "Start",
    "events.toolCall.end": "End",
    "events.taskComplete.title": "Task complete",
    "events.taskComplete.label": "Summary",
    "events.taskComplete.metrics.iterations": "{count} iterations",
    "events.taskComplete.metrics.tokens": "{count} tokens",
    "events.taskComplete.metrics.duration": "{duration}",
    "events.taskComplete.cancelled.title": "Task cancelled",
    "events.taskComplete.cancelled.body":
      "The run stopped before finishing. Submit another prompt to continue working.",
    "events.taskComplete.finalAnswer": "Final answer",
    "events.taskComplete.streaming": "Generating final answer…",
    "events.taskComplete.streamingHint": "Waiting for the run to finish.",
    "events.taskComplete.empty": "No answer provided.",
    "events.taskComplete.attachmentsAvailable":
      "Attachments are available in the task input.",
    "events.taskComplete.stopReason": "Stop reason: {reason}",
    "events.error.title": "Run failed",
    "events.error.label": "Error",
    "events.error.recoverable": "Recoverable",
    "events.error.context": "Phase {phase} · iteration {iteration}",
    "events.error.details": "Details",
    "events.workflow.node.output.delta.title": "Thinking…",
    "events.workflow.node.output.delta.hint": "Agent is working",
    "events.workflow.node.output.delta.status": "思考中",
    "events.iteration.progress": "Iteration {iteration} of {total}",
    "events.iteration.complete": "Iteration {iteration} complete",
    "events.iteration.tokens": "{count} tokens",
    "events.iteration.tools": "{count} tools",
    "events.researchPlan.title": "Research plan ({count} iterations)",
    "events.step.started": "Step {index}: {description}",
    "events.step.completed": "Step {index} complete",
    "events.browserInfo.title": "Browser diagnostics",
    "events.browserInfo.captured": "Captured {timestamp}",
    "events.browserInfo.statusLabel": "Status",
    "events.browserInfo.statusAvailable": "Available",
    "events.browserInfo.statusUnavailable": "Unavailable",
    "events.browserInfo.messageLabel": "Message",
    "events.browserInfo.userAgentLabel": "User-Agent",
    "events.browserInfo.cdpLabel": "CDP URL",
    "events.browserInfo.vncLabel": "VNC URL",
    "events.browserInfo.viewportLabel": "Viewport",
    "events.browserInfo.noData": "No diagnostics available",
    "sessions.archiveLabel": "Session archive",
    "sessions.title": "Session management",
    "sessions.description":
      "Review, revisit, and reopen elephant.ai automated workflows.",
    "sessions.newConversation": "Start new conversation",
    "sessions.card.title": "Session {id}",
    "sessions.card.lastTask": "Last task",
    "sessions.card.taskCount": "{count} tasks",
    "sessions.card.updated": "Updated {time}",
    "sessions.card.fork": "Fork",
    "sessions.card.delete": "Delete",
    "sessions.card.open": "Open session",
    "sessions.list.confirmDelete.title": "Delete session?",
    "sessions.list.confirmDelete.description":
      "This action cannot be undone. All session data will be permanently deleted.",
    "sessions.list.confirmDelete.confirm": "Delete",
    "sessions.list.confirmDelete.cancel": "Cancel",
    "sessions.list.toast.deleteSuccess.title": "Session deleted",
    "sessions.list.toast.deleteSuccess.description":
      "The session has been permanently removed.",
    "sessions.list.toast.deleteError.title": "Failed to delete session",
    "sessions.list.toast.deleteError.description": "Reason: {message}",
    "sessions.list.toast.forkSuccess.title": "Session forked successfully!",
    "sessions.list.toast.forkSuccess.description": "New session ID: {id}…",
    "sessions.list.toast.forkError.title": "Failed to fork session",
    "sessions.list.toast.forkError.description": "Reason: {message}",
    "sessions.list.error": "Error loading sessions: {message}",
    "sessions.list.empty":
      "No sessions found. Create a new task to start a session.",
    "sessions.list.loading": "Loading sessions…",
    "sessions.details.back": "Back",
    "sessions.details.title": "Session details",
    "sessions.details.sessionId": "Session ID: {id}",
    "sessions.details.status.active": "Active",
    "sessions.details.status.inactive": "Inactive",
    "sessions.details.info.title": "Session information",
    "sessions.details.info.created": "Created",
    "sessions.details.info.updated": "Last updated",
    "sessions.details.info.taskCount": "Total tasks",
    "sessions.details.newTask": "New task",
    "sessions.details.history": "Task history",
    "sessions.details.history.started": "Started {time}",
    "sessions.details.history.status.completed": "Completed",
    "sessions.details.history.status.running": "Running",
    "sessions.details.history.status.pending": "Pending",
    "sessions.details.history.status.failed": "Failed",
    "sessions.details.history.status.in_progress": "In progress",
    "sessions.details.history.status.error": "Error",
    "sessions.details.history.status.cancelled": "Cancelled",
    "sessions.details.toast.taskStarted.title": "Task started",
    "sessions.details.toast.taskStarted.description":
      "Execution has begun in this session.",
    "sessions.details.toast.taskError.title": "Failed to execute task",
    "sessions.details.toast.taskError.description": "Reason: {message}",
    "sessions.details.toast.taskCancelRequested.title":
      "Cancellation requested",
    "sessions.details.toast.taskCancelRequested.description":
      "Attempting to stop the running task.",
    "sessions.details.toast.taskCancelError.title": "Failed to cancel task",
    "sessions.details.toast.taskCancelError.description": "Reason: {message}",
    "sessions.details.error": "Error loading session: {message}",
    "sessions.details.notFound": "Session not found",
    "sessions.details.loading": "Loading session…",
    "common.error.unknown": "Unknown error",
    "sidebar.nav.search": "Search",
    "sidebar.nav.library": "Library",
    "sidebar.nav.allTasks": "All Tasks",
    "sidebar.session.recent": "Recent",
    "sidebar.session.empty": "No sessions yet",
    "sidebar.session.new": "New Session",
    "sidebar.session.rename": "Rename session",
    "sidebar.session.renamePlaceholder": "Session name",
    "sidebar.session.confirmRename": "Save name",
    "sidebar.session.cancelRename": "Cancel",
    "sidebar.session.delete": "Delete session",
    "sidebar.session.confirmDelete.title": "Delete session?",
    "sidebar.session.confirmDelete.description":
      "This action cannot be undone. All session data will be permanently deleted.",
    "sidebar.session.confirmDelete.confirm": "Delete",
    "sidebar.session.confirmDelete.cancel": "Cancel",
    "sidebar.session.toast.deleteSuccess": "Session deleted successfully",
    "sidebar.session.toast.deleteError": "Failed to delete session",
    "sidebar.toggle.open": "Open session list",
    "sidebar.toggle.close": "Close session list",
    "header.actions.share": "Share",
    "header.actions.more": "More actions",
    "header.actions.export": "Export",
    "header.actions.delete": "Delete",
    "inputBar.placeholder": "Type your message…",
    "inputBar.actions.attach": "Attach file",
    "inputBar.actions.voice": "Voice input",
    "inputBar.actions.send": "Send message",
    "inputBar.actions.sending": "Sending…",
    "inputBar.hint.shortcut": "Enter to send, Shift+Enter for new line",
  },
} as const;

export type TranslationKey = keyof typeof translations.en;

export type TranslationParams = Record<string, string | number>;

interface LanguageContextValue {
  language: Language;
  setLanguage: (language: Language) => void;
  t: (key: TranslationKey, params?: TranslationParams) => string;
}

const languageLocaleMap: Record<Language, string> = {
  en: "en-US",
};

type LanguageStore = {
  language: Language;
  setLanguage: (language: Language) => void;
};

export const useLanguageStore = create<LanguageStore>()(
  persist(
    (set) => ({
      language: "en",
      setLanguage: (language) => set({ language }),
    }),
    {
      name: "alex-language",
    },
  ),
);

export function getLanguageLocale(language: Language): string {
  return languageLocaleMap[language] ?? "en-US";
}

function format(template: string, params?: TranslationParams) {
  if (!params) return template;
  return template.replace(/\{(\w+)\}/g, (_, token: string) => {
    const value = params[token];
    return value !== undefined ? String(value) : `{${token}}`;
  });
}

function translateKey(key: TranslationKey, language: Language, params?: TranslationParams) {
  const dictionary = translations[language] ?? translations.en;
  const template = (dictionary[key] ?? translations.en[key]) as string;
  return format(template, params);
}

export function LanguageProvider({ children }: { children: ReactNode }) {
  return <>{children}</>;
}

export function useI18n(): LanguageContextValue {
  const language = useLanguageStore((state) => state.language);
  const setLanguage = useLanguageStore((state) => state.setLanguage);

  const t = useCallback(
    (key: TranslationKey, params?: TranslationParams) => translateKey(key, language, params),
    [language],
  );

  return { language, t, setLanguage };
}

export function useTranslation() {
  const { t } = useI18n();
  return t;
}
