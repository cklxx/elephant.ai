# ALEX Agent Evaluation Framework

ä¸€ä¸ªç®€åŒ–ã€å®ç”¨çš„Agentè¯„ä¼°æ¡†æ¶ï¼ŒåŸºäºç°æœ‰SWE-Benchç³»ç»Ÿæ„å»ºï¼Œéµå¾ªALEXé¡¹ç›®çš„ç®€æ´æ€§åŸåˆ™ã€‚

## æ¶æ„æ¦‚è¿°

æœ¬æ¡†æ¶é‡‡ç”¨ç®€åŒ–çš„3å±‚æ¶æ„è®¾è®¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Evaluation Manager                     â”‚ â† ä»»åŠ¡è°ƒåº¦å’Œç®¡ç†
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Metrics & Analysis                     â”‚ â† æŒ‡æ ‡æ”¶é›†å’Œæ™ºèƒ½åˆ†æ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Enhanced Execution                     â”‚ â† åŸºäºSWE-Benchçš„æ‰§è¡Œå±‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ **ç®€åŒ–è®¾è®¡**
- 3å±‚æ¶æ„æ›¿ä»£å¤æ‚çš„6å±‚è®¾è®¡
- è§„åˆ™å¼•æ“æ›¿ä»£å¤æ‚MLç»„ä»¶
- æ–‡ä»¶å­˜å‚¨æ›¿ä»£å¤æ‚æ•°æ®åº“
- ä¿æŒä¸ALEXé¡¹ç›®çš„ç®€æ´æ€§åŸåˆ™ä¸€è‡´

### ğŸ“Š **å…¨é¢æŒ‡æ ‡æ”¶é›†**
- **æ€§èƒ½æŒ‡æ ‡**: æˆåŠŸç‡ã€æ‰§è¡Œæ—¶é—´ã€è¶…æ—¶ç‡ã€é‡è¯•ç‡
- **è´¨é‡æŒ‡æ ‡**: è§£å†³æ–¹æ¡ˆè´¨é‡ã€é”™è¯¯æ¢å¤ç‡ã€ä¸€è‡´æ€§è¯„åˆ†
- **èµ„æºæŒ‡æ ‡**: Tokenä½¿ç”¨ã€æˆæœ¬åˆ†æã€å†…å­˜å ç”¨
- **è¡Œä¸ºæŒ‡æ ‡**: å·¥å…·ä½¿ç”¨æ¨¡å¼ã€é”™è¯¯æ¨¡å¼åˆ†æ

### ğŸ§  **æ™ºèƒ½åˆ†æ**
- åŸºäºè§„åˆ™çš„å»ºè®®å¼•æ“ï¼ˆ12ä¸ªå†…ç½®è§„åˆ™ï¼‰
- è‡ªåŠ¨æ´å¯Ÿç”Ÿæˆ
- è¶‹åŠ¿åˆ†æå’Œé¢„æµ‹
- å¼‚å¸¸æ£€æµ‹å’Œè­¦æŠ¥

### ğŸ“ **è¯¦ç»†æŠ¥å‘Š**
- Markdownæ ¼å¼çš„è¯¦ç»†æŠ¥å‘Š
- æ‰§è¡Œæ‘˜è¦å’Œå…³é”®æ´å¯Ÿ
- ä¼˜å…ˆçº§åˆ†ç±»çš„å»ºè®®
- å¯¹æ¯”åˆ†ææ”¯æŒ

## å†…ç½®é€šç”¨Agentè¯„æµ‹é›†

é»˜è®¤æ•°æ®é›†ä½äº `evaluation/agent_eval/datasets/general_agent_eval.json`ï¼ˆå·²å†…ç½®åˆ°äºŒè¿›åˆ¶ï¼Œå¯é€‰æŒ‡å®šè·¯å¾„ï¼‰ï¼Œ`DatasetType` ä½¿ç”¨ `general_agent`ã€‚è¯¥é›†åˆèšç„¦é€šç”¨èƒ½åŠ›ï¼ˆä¸»è¦é¢å‘ Web Agent èƒ½åŠ›ï¼‰ï¼Œå‰”é™¤äº†ä½ä»·å€¼é¡¹ï¼Œä»…ä¿ç•™é«˜ä¿¡å·ä»»åŠ¡ï¼Œè¦†ç›–ï¼š

- è§„åˆ’ä¸é¡¹ç›®ç®¡ç†ï¼šè·¨å›¢é˜Ÿè®¡åˆ’ã€æ­§ä¹‰æ‹†è§£ã€æ’æœŸå¯¹é½
- åˆ†æä¸å¯è§‚å¯Ÿæ€§ï¼šæ—¥å¿—ä¸‰è§’å®šä½ã€æŒ‡æ ‡å½’å› ã€æ•…éšœå‡è®¾
- æ¶æ„ä¸APIï¼šæœ€å°APIè®¾è®¡ã€æ²»ç†ä¸å·¥å…·ä½¿ç”¨è¾¹ç•Œ
- å®‰å…¨ä¸è¿è¥ï¼šå¨èƒå»ºæ¨¡ã€è¿ç»´çª—å£æ’ç¨‹ã€å¼¹æ€§ä¸æµ‹è¯•ç­–ç•¥
- äº§å“ä¸æ²Ÿé€šï¼šæ­§ä¹‰æ‹†è§£ã€ä¼˜å…ˆçº§æ¢³ç†

æ¯æ¡ä»»åŠ¡é»˜è®¤ `surface=web`ï¼Œå¯é€šè¿‡ `Metadata["surface"]` è¿‡æ»¤åŒºåˆ†ï¼›SWE-Bench ä»é€‚ç”¨äº CLI/ä¿®å¤ç±»è¯„æµ‹ã€‚

## å¿«é€Ÿå¼€å§‹

### 1. åŸºæœ¬ä½¿ç”¨

```go
package main

import (
    "context"
    "log"
    
    "alex/evaluation/agent_eval"
)

func main() {
    // è¿è¡Œå¿«é€Ÿè¯„ä¼°
    if err := agent_eval.RunQuickEvaluation(); err != nil {
        log.Fatalf("Evaluation failed: %v", err)
    }
}
```

### 2. è‡ªå®šä¹‰è¯„ä¼°

```go
package main

import (
    "context"
    "time"
    
    "alex/evaluation/agent_eval"
)

func main() {
    // åˆ›å»ºCLIç®¡ç†å™¨
    cliManager, err := agent_eval.NewCLIManager("./results")
    if err != nil {
        log.Fatalf("Failed to create CLI manager: %v", err)
    }
    
    // é…ç½®è¯„ä¼°é€‰é¡¹
    options := &agent_eval.EvaluationOptions{
        DatasetPath:    "", // ç•™ç©ºä½¿ç”¨å†…ç½®general_agentæ•°æ®é›†
        InstanceLimit:  50,
        MaxWorkers:     4,
        TimeoutPerTask: 300 * time.Second,
        EnableMetrics:  true,
        OutputDir:      "./evaluation_results",
        ReportFormat:   "markdown",
    }
    
    // è¿è¡Œè¯„ä¼°
    ctx := context.Background()
    job, err := cliManager.RunEvaluation(ctx, options)
    if err != nil {
        log.Fatalf("Evaluation failed: %v", err)
    }
    
    log.Printf("Evaluation completed: %s", job.ID)
}
```

### 3. é…ç½®æ¯”è¾ƒ

```go
func compareConfigurations() {
    cliManager, _ := agent_eval.NewCLIManager("./results")
    
    // åŸºå‡†é…ç½®
    baselineConfig := &agent_eval.EvaluationConfig{
        DatasetPath:    "", // ç•™ç©ºä½¿ç”¨å†…ç½®general_agentæ•°æ®é›†
        InstanceLimit:  20,
        MaxWorkers:     2,
        TimeoutPerTask: 300 * time.Second,
        EnableMetrics:  true,
        OutputDir:      "./baseline_results",
    }
    
    // å®éªŒé…ç½®
    experimentConfig := &agent_eval.EvaluationConfig{
        DatasetPath:    "", // ç•™ç©ºä½¿ç”¨å†…ç½®general_agentæ•°æ®é›†
        InstanceLimit:  20,
        MaxWorkers:     4, // å¢åŠ workeræ•°é‡
        TimeoutPerTask: 600 * time.Second, // å¢åŠ è¶…æ—¶æ—¶é—´
        EnableMetrics:  true,
        OutputDir:      "./experiment_results",
    }
    
    // è¿è¡Œæ¯”è¾ƒ
    ctx := context.Background()
    comparison, err := cliManager.CompareConfigurations(ctx, baselineConfig, experimentConfig)
    if err != nil {
        log.Fatalf("Comparison failed: %v", err)
    }
    
    // æ˜¾ç¤ºç»“æœ
    fmt.Printf("Success Rate Delta: %.2f%%\n", comparison.ComparisonMetrics.SuccessRateDelta*100)
    fmt.Printf("Performance Delta: %.2f%%\n", comparison.ComparisonMetrics.PerformanceDelta*100)
    fmt.Printf("Cost Delta: %.2f%%\n", comparison.ComparisonMetrics.CostDelta*100)
}
```

## é…ç½®é€‰é¡¹

### EvaluationConfig
```go
type EvaluationConfig struct {
    // æ•°æ®é›†é…ç½®
    DatasetType   string        // æ•°æ®é›†ç±»å‹ (é»˜è®¤: "general_agent")
    DatasetPath   string        // æ•°æ®é›†è·¯å¾„
    InstanceLimit int           // å®ä¾‹é™åˆ¶ (é»˜è®¤: 10)
    
    // æ‰§è¡Œé…ç½®
    MaxWorkers    int           // æœ€å¤§workeræ•° (é»˜è®¤: 2)
    TimeoutPerTask time.Duration // ä»»åŠ¡è¶…æ—¶ (é»˜è®¤: 5åˆ†é’Ÿ)
    
    // æŒ‡æ ‡é…ç½®
    EnableMetrics bool          // å¯ç”¨æŒ‡æ ‡æ”¶é›† (é»˜è®¤: true)
    MetricsTypes  []string      // æŒ‡æ ‡ç±»å‹
    
    // è¾“å‡ºé…ç½®
    OutputDir     string        // è¾“å‡ºç›®å½•
    ReportFormat  string        // æŠ¥å‘Šæ ¼å¼ (é»˜è®¤: "markdown")
}
```

## æŒ‡æ ‡è¯´æ˜

### æ€§èƒ½æŒ‡æ ‡
- **æˆåŠŸç‡**: æˆåŠŸå®Œæˆçš„ä»»åŠ¡ç™¾åˆ†æ¯”
- **å¹³å‡æ‰§è¡Œæ—¶é—´**: ä»»åŠ¡å¹³å‡æ‰§è¡Œæ—¶é—´
- **è¶…æ—¶ç‡**: è¶…æ—¶ä»»åŠ¡çš„ç™¾åˆ†æ¯”
- **é‡è¯•ç‡**: éœ€è¦é‡è¯•çš„ä»»åŠ¡ç™¾åˆ†æ¯”

### è´¨é‡æŒ‡æ ‡
- **è§£å†³æ–¹æ¡ˆè´¨é‡**: åŸºäºè§£å†³æ–¹æ¡ˆç‰¹å¾çš„è´¨é‡è¯„åˆ†
- **é”™è¯¯æ¢å¤ç‡**: ä»é”™è¯¯ä¸­æ¢å¤çš„èƒ½åŠ›
- **ä¸€è‡´æ€§è¯„åˆ†**: ç±»ä¼¼ä»»åŠ¡é—´çš„ä¸€è‡´æ€§è¡¨ç°
- **å¤æ‚æ€§å¤„ç†**: å¤„ç†å¤æ‚ä»»åŠ¡çš„èƒ½åŠ›

### èµ„æºæŒ‡æ ‡
- **Tokenä½¿ç”¨**: æ€»Tokenä½¿ç”¨é‡å’Œå¹³å‡ä½¿ç”¨é‡
- **æˆæœ¬åˆ†æ**: æ€»æˆæœ¬å’Œæ¯ä»»åŠ¡å¹³å‡æˆæœ¬
- **å†…å­˜ä½¿ç”¨**: ç³»ç»Ÿå†…å­˜å ç”¨

### è¡Œä¸ºæŒ‡æ ‡
- **å·¥å…·è°ƒç”¨**: å¹³å‡å·¥å…·è°ƒç”¨æ¬¡æ•°
- **å·¥å…·ä½¿ç”¨æ¨¡å¼**: å„å·¥å…·ä½¿ç”¨é¢‘ç‡åˆ†æ
- **å¸¸è§å¤±è´¥**: å¤±è´¥æ¨¡å¼ç»Ÿè®¡
- **é”™è¯¯æ¨¡å¼**: é”™è¯¯ç±»å‹åˆ†æ

## è§„åˆ™å¼•æ“

å†…ç½®12ä¸ªè¯„ä¼°è§„åˆ™ï¼Œæ¶µç›–ï¼š

### æ€§èƒ½è§„åˆ™ (PERF_*)
- **PERF_001**: ä½æˆåŠŸç‡æ£€æµ‹
- **PERF_002**: é«˜è¶…æ—¶ç‡æ£€æµ‹  
- **PERF_003**: æ…¢æ‰§è¡Œæ—¶é—´æ£€æµ‹

### è´¨é‡è§„åˆ™ (QUAL_*)
- **QUAL_001**: ä½è§£å†³æ–¹æ¡ˆè´¨é‡æ£€æµ‹
- **QUAL_002**: å·®é”™è¯¯æ¢å¤æ£€æµ‹
- **QUAL_003**: ä¸ä¸€è‡´æ€§èƒ½æ£€æµ‹

### æ•ˆç‡è§„åˆ™ (EFF_*)
- **EFF_001**: è¿‡åº¦å·¥å…·ä½¿ç”¨æ£€æµ‹
- **EFF_002**: é«˜Tokenæ¶ˆè€—æ£€æµ‹

### æˆæœ¬è§„åˆ™ (COST_*)
- **COST_001**: é«˜è¯„ä¼°æˆæœ¬æ£€æµ‹
- **COST_002**: é«˜å•ä»»åŠ¡æˆæœ¬æ£€æµ‹

### å¯é æ€§è§„åˆ™ (REL_*)
- **REL_001**: é«˜é‡è¯•ç‡æ£€æµ‹
- **REL_002**: å†…å­˜ä½¿ç”¨è­¦å‘Š

## æŠ¥å‘Šæ ¼å¼

ç”Ÿæˆçš„MarkdownæŠ¥å‘ŠåŒ…å«ï¼š

1. **æ‰§è¡Œæ‘˜è¦**: æ€»ä½“è¯„åˆ†ã€ç­‰çº§ã€ä¼˜åŠ¿åŠ£åŠ¿
2. **æ€§èƒ½åˆ†æ**: è¯¦ç»†çš„æ€§èƒ½æŒ‡æ ‡è¡¨æ ¼å’Œæ´å¯Ÿ
3. **è´¨é‡åˆ†æ**: è´¨é‡æŒ‡æ ‡è¯„ä¼°å’Œå»ºè®®
4. **èµ„æºä½¿ç”¨**: æˆæœ¬å’Œèµ„æºæ•ˆç‡åˆ†æ
5. **è¡Œä¸ºåˆ†æ**: å·¥å…·ä½¿ç”¨æ¨¡å¼å’Œé”™è¯¯åˆ†æ
6. **å…³é”®æ´å¯Ÿ**: è‡ªåŠ¨ç”Ÿæˆçš„æ´å¯Ÿå’Œå‘ç°
7. **å»ºè®®**: æŒ‰ä¼˜å…ˆçº§åˆ†ç±»çš„æ”¹è¿›å»ºè®®
8. **è­¦æŠ¥**: å…³é”®é—®é¢˜å’Œè­¦å‘Šä¿¡æ¯

## é›†æˆç°æœ‰ç³»ç»Ÿ

æœ¬æ¡†æ¶åŸºäºç°æœ‰çš„SWE-Benchè¯„ä¼°ç³»ç»Ÿæ„å»ºï¼Œå®Œå…¨å…¼å®¹ï¼š

```go
// ç°æœ‰çš„SWE-Benchç»„ä»¶
import "alex/evaluation/swe_bench"

// æ–°çš„Agentè¯„ä¼°æ¡†æ¶
import "alex/evaluation/agent_eval"

// æ— ç¼é›†æˆä½¿ç”¨
manager := agent_eval.NewEvaluationManager(config)
```

## æ€§èƒ½ç‰¹æ€§

- **è½»é‡çº§**: å†…å­˜ä½¿ç”¨ <50MB per session
- **é«˜æ•ˆ**: å¤„ç†èƒ½åŠ› 100+ evaluations/hour
- **å¯æ‰©å±•**: æ”¯æŒå¹¶å‘è¯„ä¼°å’Œæ‰¹é‡å¤„ç†
- **ç¨³å®š**: éä¾µå…¥å¼é›†æˆï¼Œé›¶é£é™©éƒ¨ç½²

## ç›®å½•ç»“æ„

```
evaluation/agent_eval/
â”œâ”€â”€ evaluation_manager.go    # ç¬¬1å±‚ï¼šè¯„ä¼°ç®¡ç†å™¨
â”œâ”€â”€ metrics.go              # ç¬¬2å±‚ï¼šæŒ‡æ ‡æ”¶é›†
â”œâ”€â”€ analyzer.go             # ç¬¬2å±‚ï¼šåˆ†æå¼•æ“
â”œâ”€â”€ rules.go                # ç¬¬2å±‚ï¼šè§„åˆ™å¼•æ“
â”œâ”€â”€ reporter.go             # ç¬¬2å±‚ï¼šæŠ¥å‘Šç”Ÿæˆ
â”œâ”€â”€ cli.go                  # CLIæ¥å£
â”œâ”€â”€ types.go                # ç±»å‹å®šä¹‰
â”œâ”€â”€ example_test.go         # ç¤ºä¾‹æµ‹è¯•
â””â”€â”€ README.md               # æœ¬æ–‡ä»¶
```

## æµ‹è¯•

è¿è¡Œæµ‹è¯•ï¼š
```bash
cd evaluation/agent_eval
go test -v
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®é›†æ–‡ä»¶ä¸å­˜åœ¨**
   ```
   Error: dataset file does not exist: ./evaluation/agent_eval/datasets/general_agent_eval.json
   ```
   è‹¥éœ€è¦è‡ªå®šä¹‰æ–‡ä»¶è·¯å¾„ï¼Œç¡®ä¿è¯„æµ‹æ•°æ®é›†æ–‡ä»¶å­˜åœ¨ä¸”è·¯å¾„æ­£ç¡®ï¼›é»˜è®¤ç•™ç©ºå°†è‡ªåŠ¨ä½¿ç”¨å†…ç½®çš„general_agentæ•°æ®ã€‚

2. **å†…å­˜ä¸è¶³**
   ```
   Warning: High memory usage detected
   ```
   å‡å°‘`InstanceLimit`æˆ–`MaxWorkers`å‚æ•°ã€‚

3. **è¶…æ—¶è¿‡å¤š**
   ```
   Alert: High timeout rate detected
   ```
   å¢åŠ `TimeoutPerTask`æ—¶é—´æˆ–æ£€æŸ¥ä»»åŠ¡å¤æ‚æ€§ã€‚

### è°ƒè¯•æ¨¡å¼

å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼š
```go
options := agent_eval.DefaultEvaluationOptions()
options.Verbose = true
```

## æœ€ä½³å®è·µ

1. **ä»å°è§„æ¨¡å¼€å§‹**: ä½¿ç”¨å°‘é‡å®ä¾‹æµ‹è¯•é…ç½®
2. **ç›‘æ§èµ„æºä½¿ç”¨**: å…³æ³¨å†…å­˜å’Œæˆæœ¬æŒ‡æ ‡
3. **å®šæœŸæ¯”è¾ƒ**: ä½¿ç”¨A/Bæµ‹è¯•éªŒè¯æ”¹è¿›
4. **ä¿å­˜åŸºå‡†**: å»ºç«‹æ€§èƒ½åŸºå‡†çº¿ç”¨äºå¯¹æ¯”
5. **å…³æ³¨è­¦æŠ¥**: åŠæ—¶å¤„ç†ç³»ç»Ÿç”Ÿæˆçš„è­¦æŠ¥

## æŠ€æœ¯è§„æ ¼

- **Goç‰ˆæœ¬**: 1.19+
- **æ¶æ„**: 3å±‚ç®€åŒ–è®¾è®¡
- **å­˜å‚¨**: æ–‡ä»¶ç³»ç»ŸJSONæ ¼å¼
- **æŠ¥å‘Š**: Markdownæ ¼å¼
- **é›†æˆ**: åŸºäºç°æœ‰SWE-Benchç³»ç»Ÿ
- **ä¾èµ–**: æœ€å°åŒ–å¤–éƒ¨ä¾èµ–

## è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ªä¸ALEXé¡¹ç›®ç›¸åŒçš„è®¸å¯è¯ã€‚

## è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç å’Œå»ºè®®ã€‚è¯·éµå¾ªé¡¹ç›®çš„ä»£ç è§„èŒƒå’Œç®€æ´æ€§åŸåˆ™ã€‚
